<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta name="theme-color" content="#8e3dbc">
    <link rel="icon" type="image/png" sizes="32x32" href="img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="img/favicon-16x16.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link inline rel="stylesheet" type="text/css" href="css/formulario.css" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"rel="stylesheet"/>
    <script src="https://kit.fontawesome.com/e97cfc6afc.js"></script>
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <title>Adicionar banheiro</title>
  </head>
  <body>
    <div class="navbar-fixed">
    <nav>
      <div class="nav-wrapper">
        <a class="brand-logo center">ToiletFY</a>
        <ul class="right hide-on-med-and-down">
          <li>
            <a href="index.html" title="Página inicial"><i class="material-icons">home</i></a>
          </li>
          <li>
            <a href="reportar.html" title="Reportar erros"><i class="material-icons">report_problem</i></a>
          </li>
          <li>
            <a href="sobre.html" title="Sobre ToiletFY"><i class="material-icons">info</i></a>
          </li>
        </ul>

        <ul id="nav-mobile" class="sidenav">
          <li>
            <a href="index.html"
              ><i class="material-icons">home</i>Página inicial</a
            >
          </li>
          <hr />
          <li>
                <a href="reportar.html"><i class="material-icons">report_problem</i>Reportar problemas</a>
              </li>
              <hr />
          <li>
            <a href="sobre.html"><i class="material-icons">info</i>Sobre</a>
          </li>
          <hr />
          <br /><br /><br /><br /><br />
          <li class="warning">
            <a href="privacidade.html"><i class="material-icons">lock</i>Política de Privacidade</a>
          </li>
        </ul>
        <a href="#" data-target="nav-mobile" class="sidenav-trigger"
          ><i class="material-icons">menu</i></a
        >
      </div>
    </nav>
  </div>
    <div class="containers">  
      <div id="contacts" autocorrect="off" name="adicionar" autocomplete="off" method="post">
        <h3>Adicionar banheiro</h3>
        <br>
        <fieldset class="fs">
        <input id="nome" name="nome" placeholder="Seu nome" type="text" tabindex="1" autofocus>
      </fieldset>
      <fieldset class="fs">
        <input  class="input-field" id="nomelocal" name="nomelocal" placeholder="Nome do local" type="text"  tabindex="2" required>
      </fieldset>
      <fieldset class="fs"> 
        <input  class="input-field localizacao" name="endereco" id="endereco"  type="text"  placeholder="Endereço"  readonly tabindex="3" required>
        <div class="location" id="showMe"title="Usar minha localização"></div>
        <button type="button" class="waves-effect waves-light btn center-align procurar" title="Procurar local no mapa"><i class="material-icons left">search</i>Procurar no mapa</button>
          <div class="pesquisarmapa">
          <div class="content">
          <div id="map"></div>
          </div>
          </div>
          <div id="mapa" style="width:10%; height:10%"></div>
      </fieldset>
        <fieldset class="fs" id="legend">
          <legend>Informações</legend>
          <p>
          <label>
            <input type="checkbox" class="filled-in checkbox1 informacoes" name="informacoes[]" value="Necessita pagamento para usar" id="pagamento"> 
            <span>Necessita pagamento para usar <i class="fas fa-money-bill-alt money"></i></span>
          </label>
        </p>
        <p>
          <label>
            <input type="checkbox" class="filled-in checkbox1 informacoes"  name="informacoes[]" value="Banheiro adaptado para PcD" id="adaptado"> 
            <span>Banheiro adaptado para PcD  <i class="fab fa-accessible-icon pcd"></i></span>
          </label>
        </p>
        <p>
          <label>
            <input type="checkbox" class="filled-in checkbox1 informacoes"  name="informacoes[]" value="Possui fraldário" id="fraldario"> 
            <span>Possui fraldário <i class="fas fa-baby fraldario"></i></span>
          </label>
        </p>
        </fieldset>
        <fieldset class="fs">
          <div class="input-field col s12">
            <select id="horario">
              <option disabled selected>Selecione o horário de funcionamento do banheiro</option>
              <option value="7h às 21h">7h às 21h</option>
              <option value="7h às 22h">7h às 22h</option>
              <option value="8h às 21h">8h às 21h</option>
              <option value="9h às 18h">9h às 18h</option>
              <option value="10h às 22h">10h às 22h</option>
              <option value="24h">24h</option>
              <option value="Sem informação sobre o horário de funcionamento do banheiro">Sem informação sobre o horário de funcionamento do banheiro</option>
            </select>
            <label>Horário de Funcionamento</label>
          </div>
        </fieldset>
        <fieldset class="fs star" id="legend">
        <legend>Avaliação</legend>
        <div class="rating">
          <br><br>
              <input type="radio" name="star" id="star5"  required><label for="star5"></label>
              <input type="radio" name="star" id="star4"><label for="star4"></label>
              <input type="radio" name="star" id="star3"><label for="star3"></label>
              <input type="radio" name="star" id="star2"><label for="star2"></label>
              <input type="radio" name="star" id="star1"><label for="star1"></label>
        </div>
        </fieldset>
        <fieldset class="fs">
          <legend>Observação</legend>
          <textarea class="input-field" name="observacao" placeholder ="Alguma observação sobre o uso do banheiro?" id="obs" tabindex="4" class="textarea"></textarea>
        </fieldset>
        <fieldset class="fs">
            <textarea class="input-field" class="textarea1" name="informacao" id="textarea1"><img src=''img/seminfo.png'' width=''120px'' title='' '' alt='' ''></textarea>
            <input id="inputavaliacao" type="text" name="avaliacao" readonly value="Sem avaliação">
            <input id="valorlat" type="text" name="latitude" readonly value="">
            <input id="valorlong" type="text" name="longitude" readonly value="">
           <button id="submit" name="submit" class=" waves-effect waves-light btn center-align" type="button" onclick="adicionar()" id="contact-submit" data-submit="Enviando..."><i class="material-icons left">
            cloud_upload</i>ENVIAR</button>
        </fieldset>
      </div>
    </div>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="js/jquery.min.js"></script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAjpzomu3rr8iX1yMYdOgkevViVGzsbGLU"></script>
    <script src="js/marcador.js"></script>
    <script src="js/map.js"></script>
    <script src="js/materialize.js"></script>
    <script src="js/adicionar.js"></script>
    <script src="js/init.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.js"></script>
    <script>

      $(document).ready(function(){
          $('select').formSelect();
        });

      var textarea = $("#textarea1").clone();

      async function adicionar() {
        var nome = document.getElementById("nome").value;
        var nomelocal = document.getElementById("nomelocal").value;
        var endereco = document.getElementById("endereco").value;
        var horario =  $('#horario').val();
        var infohorarios = "<br><br> Horário de funcionamento: " + horario;
        var observacao = document.getElementById("obs").value + infohorarios;
        var avaliacao = document.getElementById("inputavaliacao").value;
        var informacao = document.getElementById("textarea1").value;
        var valorlat = document.getElementById("valorlat").value;
        var valorlong = document.getElementById("valorlong").value;
        var rating = $('input[name="star"]:checked').val();

        console.log(infohorarios);

        console.log(observacao);


        if (nomelocal == "") return swal("Atenção", "O nome do local não pode ficar em branco!", "warning");
        if (endereco == "") return swal("Atenção","O endereço não pode ficar em branco!", "warning");
        if (horario == null) return swal("Atenção","Por favor, informe o horário de funcionamento do banheiro!", "warning");
        if (rating == null) return swal("Atenção","Por favor, avalie o banheiro!", "warning");

        const response = await axios.post("https://toiletfy.com.br/adicionarbanheiro", {
          nome: nome,
          nomelocal: nomelocal,
          endereco: endereco,
          observacao:observacao,
          avaliacao: avaliacao,
          informacao: informacao,
          latitude: valorlat,
          longitude: valorlong
        });

        console.log(response.data);

        if (response.data.affectedRows == "1") {
          swal("Obrigado","Banheiro adicionado com sucesso!", "success");
          $(':input', '#contacts')
          .not(':button, :submit, :reset, :hidden')
          .val('')
          .removeAttr('checked')
          .removeAttr('selected');
          $('#textarea1').val("<img src=''img/seminfo.png'' width=''120px'' title='' '' alt='' ''>");
          $('#horario').prop('selectedIndex',0);
        }else{
          swal("Erro","Ocorreu um problema ao adicionar, tente novamente!", "error");
          $(':input', '#contacts')
          .not(':button, :submit, :reset, :hidden')
          .val('')
          .removeAttr('checked')
          .removeAttr('selected');
          $('#textarea1').val("<img src=''img/seminfo.png'' width=''120px'' title='' '' alt='' ''>");
          $('#horario').prop('selectedIndex',0);

        }
      }
    </script>
</body>
</html>
